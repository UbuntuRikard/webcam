<!DOCTYPE html>
<html lang="en">
<!--
This file is part of Webcam App - made by:
Copyright (C) 2025 Rikard Svenningsen

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
-->
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Webcam Streamer</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="/webcam/manifest.json"> 
</head>
<body>
    <div class="controls-left">
        <button id="zoom8Btn" class="zoom-btn">x8</button>
        <button id="zoom7Btn" class="zoom-btn">x7</button>
        <button id="zoom6Btn" class="zoom-btn">x6</button>
        <button id="zoom5Btn" class="zoom-btn">x5</button>
        <button id="zoom4Btn" class="zoom-btn">x4</button>
        <button id="zoom3Btn" class="zoom-btn">x3</button>
        <button id="zoom2Btn" class="zoom-btn">x2</button>
        <button id="zoom1Btn" class="zoom-btn">x1</button>
    </div>

    <video id="video" autoplay playsinline style="display:none;"></video>
    <canvas id="canvas" style="display:block;"></canvas>

    <div id="overlay">
        <div id="ipaddress" class="overlay-info"></div>
        <div id="appVersion" class="overlay-info"></div>
        <div id="battery" class="overlay-info"></div>
    </div>

    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>
    <div id="status"></div>

    <div id="controls">
        <div id="connection-config">
            <input type="text" id="serverIp" placeholder="192.168.1.42" class="compact-input" />
            <input type="text" id="serverPort" placeholder="8181" value="8181" class="compact-input" />
            <button id="saveConfigBtn" class="icon-button"><i class="fas fa-save"></i></button>
        </div>

        <div id="controls-container">
            <select id="cameraSelect" class="compact-select"></select>
            <select id="resolutionSelect" class="compact-select">
                <option value="vga">640x480</option>
                <option value="hd">1280x720</option>
                <option value="fhd">1920x1080</option>
            </select>
            <select id="fpsSelect" class="compact-select">
                <option value="5">5 FPS</option>
                <option value="10" selected>10 FPS</option>
                <option value="20">20 FPS</option>
            </select>
            <button id="startBtn" class="icon-text-button"><i class="fas fa-play"></i> Start</button>
            <button id="stopBtn" class="icon-text-button"><i class="fas fa-stop"></i> Stop</button>
        </div>
    </div>

    <script src="webcam.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Register the service worker, ensuring the path is correct for GitHub Pages
                navigator.serviceWorker.register('/webcam/sw.js') 
                    .then(registration => {
                        console.log('Service Worker registered! Scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
